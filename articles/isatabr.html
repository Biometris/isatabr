<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="isatabr">
<title>An introduction to the isatabr package • isatabr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="An introduction to the isatabr package">
<meta property="og:description" content="isatabr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">isatabr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/index.html">Vignettes</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--other-packages">
    <span class="fa fa-seedling"></span>
     
    other packages
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--other-packages">
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenSTA">statgenSTA</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenGxE">statgenGxE</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenGWAS">statgenGWAS</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenHTP">statgenHTP</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenIBD">statgenIBD</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenMPP">statgenMPP</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/LMMsolver">LMMsolver</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Biometris/isatabr">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="isatabr_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>An introduction to the isatabr package</h1>
                        <h4 data-toc-skip class="author">Bart-Jan van Rossum</h4>
            
            <h4 data-toc-skip class="date">2022-08-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Biometris/isatabr/blob/HEAD/vignettes/isatabr.Rmd" class="external-link"><code>vignettes/isatabr.Rmd</code></a></small>
      <div class="d-none name"><code>isatabr.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="the-isatabr-package">The isatabr package<a class="anchor" aria-label="anchor" href="#the-isatabr-package"></a>
</h2>
<p>The isatabr package is developed as a easy-to-use package for reading, modifying and writing files in the Investigation/Study/Assay (ISA) Abstract Model of the metadata framework using the ISA tab-delimited (TAB) format.</p>
<p>ISA is a metadata framework to manage an increasingly diverse set of life science, environmental and biomedical experiments that employ one or a combination of technologies. Built around the <strong>Investigation</strong> (the project context), <strong>Study</strong> (a unit of research) and <strong>Assay</strong> (analytical measurements) concepts, ISA helps you to provide rich descriptions of experimental metadata (i.e. sample characteristics, technology and measurement types, sample-to-data relationships) so that the resulting data and discoveries are reproducible and reusable.</p>
</div>
<div class="section level2">
<h2 id="the-isa-tab-structure">The ISA tab structure<a class="anchor" aria-label="anchor" href="#the-isa-tab-structure"></a>
</h2>
<p>The ISA-Tab structure is described in full detail on <a href="https://isa-specs.readthedocs.io/en/latest/isatab.html" class="external-link uri">the ISA-tab website</a>. The description below is mostly taken from there and slightly condensed when appropriate.</p>
<p>ISA-Tab uses three types of file to capture the experimental metadata:</p>
<ul>
<li>Investigation file</li>
<li>Study file</li>
<li>Assay file (with associated data files)</li>
</ul>
<p>The Investigation file contains all the information needed to understand the overall goals and means used in an experiment; experimental steps (or sequences of events) are described in the Study and in the Assay file(s). For each Investigation file there may be one or more Studies defined with a corresponding Study file; for each Study there may be one or more Assays defined with corresponding Assay files.</p>
<p>In order to facilitate identification of ISA-Tab component files, specific naming patterns should be followed:</p>
<ul>
<li>i_*.txt for identifying the Investigation file, e.g. i_investigation.txt</li>
<li>s_*.txt for identifying Study file(s), e.g. s_gene_survey.txt</li>
<li>a_*.txt for identifying Assay file(s), e.g. a_transcription.txt</li>
</ul>
<div class="section level3">
<h3 id="the-investigation-file">The Investigation file<a class="anchor" aria-label="anchor" href="#the-investigation-file"></a>
</h3>
<p>The Investigation file fulfills four needs:</p>
<ol style="list-style-type: decimal">
<li>to declare key entities, such as factors, protocols, which may be referenced in the other files;</li>
<li>to track provenance of the terminologies (controlled vocabularies or ontologies) there are used, where applicable;</li>
<li>to relate each Study file to an Investigation (this only becomes necessary when two or more Study files need to be grouped);</li>
<li>to relate Assay files to Studies.</li>
</ol>
<p>An Investigation file is structured as a table with vertical headings along the first column, and corresponding values in the subsequent columns. The following section headings must appear in the Investigation file (in order), and the study block (headings from STUDY to STUDY CONTACTS) can be repeated, one block per study associated with the investigation.</p>
<ul>
<li>ONTOLOGY SOURCE REFERENCE</li>
<li>INVESTIGATION</li>
<li>INVESTIGATION PUBLICATIONS</li>
<li>INVESTIGATION CONTACTS</li>
<li>STUDY</li>
<li>STUDY DESIGN DESCRIPTORS</li>
<li>STUDY PUBLICATIONS</li>
<li>STUDY FACTORS</li>
<li>STUDY ASSAYS</li>
<li>STUDY PROTOCOLS</li>
<li>STUDY CONTACTS</li>
</ul>
<p>For a full description of all sections see the aforementioned <a href="https://isa-specs.readthedocs.io/en/latest/isatab.html" class="external-link">site</a>.</p>
</div>
<div class="section level3">
<h3 id="the-study-file">The Study file<a class="anchor" aria-label="anchor" href="#the-study-file"></a>
</h3>
<p>The Study file contains contextualizing information for one or more assays, for example; the subjects studied; their source(s); the sampling methodology; their characteristics; and any treatments or manipulations performed to prepare the specimens.</p>
</div>
<div class="section level3">
<h3 id="the-assay-file">The Assay file<a class="anchor" aria-label="anchor" href="#the-assay-file"></a>
</h3>
<p>The Assay file represents a portion of the experimental graph (i.e., one part of the overall structure of the workflow); each Assay file must contain assays of the same type, defined by the type of measurement (e.g. gene expression) and the technology employed (e.g. DNA microarray). Assay-related information includes protocols, additional information relating to the execution of those protocols and references to data files (whether raw or derived).</p>
</div>
<div class="section level3">
<h3 id="example-data">Example data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h3>
<p>As an example for working with the <code>isatabr</code> package we will use the data set that accompanies <span class="citation">Atwell et al. (2010)</span>. The associated files are included in the package.</p>
</div>
</div>
<div class="section level2">
<h2 id="reading-files-in-the-isa-tab-format">Reading files in the ISA-Tab format<a class="anchor" aria-label="anchor" href="#reading-files-in-the-isa-tab-format"></a>
</h2>
<p>ISA-Tab files can be stored in two different ways, either as separate files in a directory, or as .zip file containing the files. The example data is included in both ways in the package. Both formats can be read into <code>R</code> using the <code>readISATab</code> function.</p>
<p>When reading ISA-Tab files from a directory, only the name of the directory, where the ISA-TAB files are located, needs to be specified.</p>
<!-- isaObject1 \<- readISATab(path = file.path(system.file("extdata/Atwell", package = "isatabr"))) -->
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Read ISA-Tab files from directory.</span></span>
<span><span class="va">isaObject1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readISATab.html">readISATab</a></span><span class="op">(</span>path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/Atwell"</span>, package <span class="op">=</span> <span class="st">"isatabr"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>When reading zipped files, both the directory, where the zip-file is located, and the name of the file need to be specified.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Read ISA-Tab files from directory.</span></span>
<span><span class="va">isaObject2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readISATab.html">readISATab</a></span><span class="op">(</span>path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"isatabr"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                         zipfile <span class="op">=</span> <span class="st">"Atwell.zip"</span><span class="op">)</span></span></code></pre></div>
<p>In both cases <code>readISATab</code> will automatically detect the Investigation, Study and Assay files assuming the naming conventions described in the previous section are followed. If this is not the case, the function will give an error indicating the problem. The imported ISA-Tab files are stored in an object of the S4 class <code>ISA</code>. Since the information is almost identical for reading files from a directory and zipped-files, the following sections will show the example for the files read from a directory only.</p>
</div>
<div class="section level2">
<h2 id="accessing-and-updating-isa-objects-">Accessing and updating ISA objects.<a class="anchor" aria-label="anchor" href="#accessing-and-updating-isa-objects-"></a>
</h2>
<p>All information from the ISA-Tab files is stored within slots in the <code>ISA</code> object. The table below gives an overview of the different slots and a brief description of the information stored in the slot. For a more exhaustive description see <code><a href="../reference/ISA-class.html">help("ISA")</a></code>. Note that an investigation may have multiple studies. Therefore, data concerning studies is stored in a <code>list</code> object, where one element in the <code>list</code> corresponds to one study. Likewise a study may consist of multiple assays and assay data is stored in a <code>list</code> object, where one element in the <code>list</code> corresponds to one assay.</p>
<table class="table">
<colgroup>
<col width="11%">
<col width="26%">
<col width="61%">
</colgroup>
<thead><tr class="header">
<th>Slot</th>
<th>Type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>path</td>
<td><code>character</code></td>
<td>path to the ISA-Tab files</td>
</tr>
<tr class="even">
<td>iFileName</td>
<td><code>character</code></td>
<td>name of the investigation file</td>
</tr>
<tr class="odd">
<td>oSR</td>
<td><code>data.frame</code></td>
<td>ONTOLOGY SOURCE REFERENCE section of investigation file</td>
</tr>
<tr class="even">
<td>invest</td>
<td><code>data.frame</code></td>
<td>INVESTIGATION section of investigation file</td>
</tr>
<tr class="odd">
<td>iPubs</td>
<td><code>data.frame</code></td>
<td>INVESTIGATION PUBLICATIONS section of investigation file</td>
</tr>
<tr class="even">
<td>iContacts</td>
<td><code>data.frame</code></td>
<td>INVESTIGATION CONTACTS section of investigation file</td>
</tr>
<tr class="odd">
<td>study</td>
<td>
<code>list</code> of <code>data.frames</code>
</td>
<td>STUDY sections of investigation file</td>
</tr>
<tr class="even">
<td>sDD</td>
<td>
<code>list</code> of <code>data.frames</code>
</td>
<td>STUDY DESIGN DESCRIPTORS sections of investigation file</td>
</tr>
<tr class="odd">
<td>sPubs</td>
<td>
<code>list</code> of <code>data.frames</code>
</td>
<td>STUDY PUBLICATIONS sections of investigation file</td>
</tr>
<tr class="even">
<td>sFacts</td>
<td>
<code>list</code> of <code>data.frames</code>
</td>
<td>STUDY FACTORS sections of investigation file</td>
</tr>
<tr class="odd">
<td>sAssays</td>
<td>
<code>list</code> of <code>data.frames</code>
</td>
<td>STUDY ASSAYS sections of investigation file</td>
</tr>
<tr class="even">
<td>sProts</td>
<td>
<code>list</code> of <code>data.frames</code>
</td>
<td>STUDY PROTOCOLS sections of investigation file</td>
</tr>
<tr class="odd">
<td>sContacts</td>
<td>
<code>list</code> of <code>data.frames</code>
</td>
<td>STUDY CONTACTS sections of investigation file</td>
</tr>
<tr class="even">
<td>sFiles</td>
<td>
<code>list</code> of <code>data.frames</code>
</td>
<td>content of study files</td>
</tr>
<tr class="odd">
<td>aFiles</td>
<td>
<code>list</code> of <code>data.frames</code>
</td>
<td>content of assay files</td>
</tr>
</tbody>
</table>
<p>All slots have corresponding functions for accessing and modifying information. The names of these access functions are the same as the slots they refer to, e.g. accessing the iFileName slot in an <code>ISA</code> object can be done using the <code><a href="../reference/iFileName.html">iFileName()</a></code> function. There is one exception to this. To prevent problems with the <code>path()</code> function, that already exists in quite some other packages, the path slot in an <code>ISA</code> object should be accessed using the <code><a href="../reference/isaPath.html">isaPath()</a></code> function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Access path for isaObjects</span></span>
<span><span class="fu"><a href="../reference/isaPath.html">isaPath</a></span><span class="op">(</span><span class="va">isaObject1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "/Users/runner/work/_temp/Library/isatabr/extdata/Atwell"</span></span>
<span><span class="fu"><a href="../reference/isaPath.html">isaPath</a></span><span class="op">(</span><span class="va">isaObject2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "/private/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T/Rtmpio0c4R"</span></span></code></pre></div>
<p>The path for <code>isaObject1</code> shows the directory from which the files were read. As <code>isaObject2</code> was read directly for a zipped archive, the files were first extracted into a temporary folder and subsequently read from there. This temporary folder is shown as the path.</p>
<p>The other slots are accessible in a similar way. Some more examples are shown below.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Access studies.</span></span>
<span><span class="va">isaStudies</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/study.html">study</a></span><span class="op">(</span><span class="va">isaObject1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Print study names.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">isaStudies</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "GMI_Atwell_study"</span></span>
<span></span>
<span><span class="co">## Access study descriptors.</span></span>
<span><span class="va">isaSDD</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sDD.html">sDD</a></span><span class="op">(</span><span class="va">isaObject1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Shows study descriptors for study GMI_Atwell_study.</span></span>
<span><span class="va">isaSDD</span><span class="op">$</span><span class="va">GMI_Atwell_study</span></span>
<span><span class="co">#&gt;                                                                                Study Design Type</span></span>
<span><span class="co">#&gt; 1 GWAS of 107 phenotypes in Arabidopsis thaliana inbred lines using ~250k SNPs in 199 accessions</span></span>
<span><span class="co">#&gt;   Study Design Type Term Accession Number Study Design Type Term Source REF</span></span>
<span><span class="co">#&gt; 1                                    &lt;NA&gt;                              &lt;NA&gt;</span></span></code></pre></div>
<p>It is not only possible to access the different slots in an <code>ISA</code> object, the slots can also be updated. As the access function, the update functions have the same name as the slots they refer to. As an example, let’s assume an error sneaked into the ONTOLOGY SOURCE REFERENCE section and we want to update one of the source versions.</p>
<p>First have a look at the current content of the ONTOLOGY SOURCE REFERENCE section.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">isaOSR</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/oSR.html">oSR</a></span><span class="op">(</span><span class="va">isaObject1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Term Source Name                                 Term Source File Term Source Version</span></span>
<span><span class="co">#&gt; 1              OBI       http://data.bioontology.org/ontologies/OBI                  23</span></span>
<span><span class="co">#&gt; 2              EFO       http://data.bioontology.org/ontologies/EFO                 118</span></span>
<span><span class="co">#&gt; 3               UO                http://purl.obolibrary.org/obo/UO                &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4        NCBITaxon http://data.bioontology.org/ontologies/NCBITAXON                   6</span></span>
<span><span class="co">#&gt; 5               PO        http://data.bioontology.org/ontologies/PO                  10</span></span>
<span><span class="co">#&gt; 6              GMI                      http://gwas.gmi.oeaw.ac.at/                &lt;NA&gt;</span></span>
<span><span class="co">#&gt;                                                          Term Source Description</span></span>
<span><span class="co">#&gt; 1                                         Ontology for Biomedical Investigations</span></span>
<span><span class="co">#&gt; 2                                                   Experimental Factor Ontology</span></span>
<span><span class="co">#&gt; 3                                                                  Unit Ontology</span></span>
<span><span class="co">#&gt; 4 National Center for Biotechnology Information (NCBI) Organismal Classification</span></span>
<span><span class="co">#&gt; 5                                                                 Plant Ontology</span></span>
<span><span class="co">#&gt; 6                                     Cataloque of Arabidopsis accessions at GMI</span></span></code></pre></div>
<p>Now we update the version of the OBI ontology source from 23 to 24. Then we update the modified ontology source <code>data.frame</code> in the <code>ISA</code> object.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Update version number.</span></span>
<span><span class="va">isaOSR</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"Term Source Version"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">24</span></span>
<span></span>
<span><span class="co">## Update oSR in ISA object.</span></span>
<span><span class="fu"><a href="../reference/oSR.html">oSR</a></span><span class="op">(</span><span class="va">isaObject1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">isaOSR</span></span>
<span></span>
<span><span class="co">## Check the updated oSR.</span></span>
<span><span class="fu"><a href="../reference/oSR.html">oSR</a></span><span class="op">(</span><span class="va">isaObject1</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Term Source Name                                 Term Source File Term Source Version</span></span>
<span><span class="co">#&gt; 1              OBI       http://data.bioontology.org/ontologies/OBI                  24</span></span>
<span><span class="co">#&gt; 2              EFO       http://data.bioontology.org/ontologies/EFO                 118</span></span>
<span><span class="co">#&gt; 3               UO                http://purl.obolibrary.org/obo/UO                &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4        NCBITaxon http://data.bioontology.org/ontologies/NCBITAXON                   6</span></span>
<span><span class="co">#&gt; 5               PO        http://data.bioontology.org/ontologies/PO                  10</span></span>
<span><span class="co">#&gt; 6              GMI                      http://gwas.gmi.oeaw.ac.at/                &lt;NA&gt;</span></span>
<span><span class="co">#&gt;                                                          Term Source Description</span></span>
<span><span class="co">#&gt; 1                                         Ontology for Biomedical Investigations</span></span>
<span><span class="co">#&gt; 2                                                   Experimental Factor Ontology</span></span>
<span><span class="co">#&gt; 3                                                                  Unit Ontology</span></span>
<span><span class="co">#&gt; 4 National Center for Biotechnology Information (NCBI) Organismal Classification</span></span>
<span><span class="co">#&gt; 5                                                                 Plant Ontology</span></span>
<span><span class="co">#&gt; 6                                     Cataloque of Arabidopsis accessions at GMI</span></span></code></pre></div>
<p>In a similar way all slots in an <code>ISA</code> object can be accessed and updated.</p>
</div>
<div class="section level2">
<h2 id="processing-assay-files">Processing assay files<a class="anchor" aria-label="anchor" href="#processing-assay-files"></a>
</h2>
<p>The assay files may contain information about the files used to store the actual data for the assay. Per assay file two types of data files may be referred to: 1) the file(s) containing the raw data, and 2) the file(s) containing derived data.</p>
<p>Looking at the assay tab file in our example data, we see that the Raw Data File column is empty, no raw data files are available. However, the Derived Data File shows the file <code>d_data.txt</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Inspect assay tab.</span></span>
<span><span class="va">isaAFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aFiles.html">aFiles</a></span><span class="op">(</span><span class="va">isaObject1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">isaAFile</span><span class="op">$</span><span class="va">a_study1.txt</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Sample Name Protocol REF Parameter Value[Organism part] Term Source REF Term Accession Number</span></span>
<span><span class="co">#&gt; 1     sample1  Phenotyping                             NA              NA                    NA</span></span>
<span><span class="co">#&gt; 2     sample2  Phenotyping                             NA              NA                    NA</span></span>
<span><span class="co">#&gt; 3     sample3  Phenotyping                             NA              NA                    NA</span></span>
<span><span class="co">#&gt; 4     sample4  Phenotyping                             NA              NA                    NA</span></span>
<span><span class="co">#&gt; 5     sample5  Phenotyping                             NA              NA                    NA</span></span>
<span><span class="co">#&gt; 6     sample6  Phenotyping                             NA              NA                    NA</span></span>
<span><span class="co">#&gt;   Parameter Value[Trait Definition File] Assay Name Raw Data File        Protocol REF</span></span>
<span><span class="co">#&gt; 1                                tdf.txt  assay1020            NA Data transformation</span></span>
<span><span class="co">#&gt; 2                                tdf.txt     assay1            NA Data transformation</span></span>
<span><span class="co">#&gt; 3                                tdf.txt  assay1131            NA Data transformation</span></span>
<span><span class="co">#&gt; 4                                tdf.txt   assay569            NA Data transformation</span></span>
<span><span class="co">#&gt; 5                                tdf.txt   assay293            NA Data transformation</span></span>
<span><span class="co">#&gt; 6                                tdf.txt   assay388            NA Data transformation</span></span>
<span><span class="co">#&gt;   Derived Data File</span></span>
<span><span class="co">#&gt; 1        d_data.txt</span></span>
<span><span class="co">#&gt; 2        d_data.txt</span></span>
<span><span class="co">#&gt; 3        d_data.txt</span></span>
<span><span class="co">#&gt; 4        d_data.txt</span></span>
<span><span class="co">#&gt; 5        d_data.txt</span></span>
<span><span class="co">#&gt; 6        d_data.txt</span></span></code></pre></div>
<p>To read the contents of the data files, either raw or derived, in the assay tab file, we can use the <code><a href="../reference/processAssay-methods.html">processAssay()</a></code> function. The exact working of this function depends on the technology type of the assay. For most technology types the data files are read as plain <code>.txt</code> files assuming a tab-delimited format. Only for mass spectrometry and microarray data the files are read differently (see the sections below). As the output above shows, the assay file in the example has a Data Transformation technology and is therefore read as tab-delimited file.</p>
<p>Before being able to process the assay file, i.e. read the data, we first have to extract the assay tabs using the <code><a href="../reference/getAssayTabs.html">getAssayTabs()</a></code> function. This function extracts all the assay files from an <code>ISA</code> object and stores them as <code>assayTab</code> objects. These <code>assayTab</code> objects contain not only the content of the assay tab file, but also extra information, e.g. technology type.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Get assay tabs for isaObject1.</span></span>
<span><span class="va">aTabObjects</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getAssayTabs.html">getAssayTabs</a></span><span class="op">(</span><span class="va">isaObject1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Process assay data.</span></span>
<span><span class="va">isaDat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/processAssay-methods.html">processAssay</a></span><span class="op">(</span>isaObject <span class="op">=</span> <span class="va">isaObject1</span>,</span>
<span>                       aTabObject <span class="op">=</span> <span class="va">aTabObjects</span><span class="op">$</span><span class="va">s_study1.txt</span><span class="op">$</span><span class="va">a_study1.txt</span>,</span>
<span>                       type <span class="op">=</span> <span class="st">"derived"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Display first rows and columns.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">isaDat</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Assay Name      LD  LDV      SD     SDV FT10 FT16 FT22 Seed Dormancy Emco5</span></span>
<span><span class="co">#&gt; 1   assay152 6.84105 32.6 93.0417 4.97494   74   87   89            NA    NA</span></span>
<span><span class="co">#&gt; 2   assay279      NA   NA      NA      NA   NA   NA   NA            NA    NA</span></span>
<span><span class="co">#&gt; 3   assay211      NA   NA      NA      NA   NA   NA   NA            NA    NA</span></span>
<span><span class="co">#&gt; 4   assay256      NA   NA      NA      NA   NA   NA   NA            NA    NA</span></span>
<span><span class="co">#&gt; 5   assay907      NA   NA      NA      NA   NA   NA   NA            NA    NA</span></span>
<span><span class="co">#&gt; 6   assay948      NA   NA      NA      NA   NA   NA   NA            NA    NA</span></span></code></pre></div>
<p>The data is now stored in <code>isaDat</code> and can be used for further analysis within <code>R</code>.</p>
<div class="section level3">
<h3 id="mass-spectrometry-assay-files">Mass spectrometry assay files<a class="anchor" aria-label="anchor" href="#mass-spectrometry-assay-files"></a>
</h3>
<p>Mass spectrometry data is often stored in Network Common Data Form (NetCDF) files, i.e. in .CDF files. Assay data containing these data will be processed in a different way than regular assay data. To be able to do this the <a href="https://bioconductor.org/packages/release/bioc/html/xcms.html" class="external-link">xcms</a> package is required. This package is available from <a href="https://bioconductor.org/" class="external-link">Bioconductor</a>.</p>
<p>As an example for the processing of mass spectrometry files we will use a subset of the quantitated LC/MS peaks from the spinal cords of 6 wild-type and 6 fatty acid amide hydrolase (FAAH) knockout mice described in <span class="citation">Saghatelian et al. (2004)</span>. A more extensive version of this data set is available in the <a href="http://www.bioconductor.org/packages/release/data/experiment/html/faahKO.html" class="external-link uri">faahKO</a> data package on Bioconductor.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Read ISA-Tab files for faahKO.</span></span>
<span><span class="va">isaObject3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readISATab.html">readISATab</a></span><span class="op">(</span>path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/faahKO"</span>, package <span class="op">=</span> <span class="st">"isatabr"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>After reading the ISA-Tab files, we can now process the mass spectrometry assay data. In this example the raw data is available, so when processing the assay we specify <code>type = "raw"</code>. The rest of the code is similar to the previous section.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Get assay tabs for isaObject3.</span></span>
<span><span class="va">aTabObjects3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getAssayTabs.html">getAssayTabs</a></span><span class="op">(</span><span class="va">isaObject3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Process assay data.</span></span>
<span><span class="va">isaDat3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/processAssay-methods.html">processAssay</a></span><span class="op">(</span>isaObject <span class="op">=</span> <span class="va">isaObject3</span>,</span>
<span>                        aTabObject <span class="op">=</span> <span class="va">aTabObjects3</span><span class="op">$</span><span class="va">s_Proteomic_profiling_of_yeast.txt</span><span class="op">$</span><span class="va">a_metabolite.txt</span>,</span>
<span>                        type <span class="op">=</span> <span class="st">"raw"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Display output.</span></span>
<span><span class="va">isaDat3</span></span></code></pre></div>
<p>As the output shows, processing the mass spectrometry data gives an object of class <code>xcmsSet</code> from the <code>xcms</code> package. This object contains all available information from the .CDF file that was read and can be used for further analysis.</p>
</div>
<div class="section level3">
<h3 id="microarray-assay-files">Microarray assay files<a class="anchor" aria-label="anchor" href="#microarray-assay-files"></a>
</h3>
<p>Microarray data is often stored in an Affymetrix Probe Results file. These <code>.CEL</code> files contain information on the probe set’s intensity values, and a probe set represents a gene. Assay data containing these data will be processed in a different way than regular assay data. To be able to do this the <a href="https://www.bioconductor.org/packages/release/bioc/html/affy.html" class="external-link">affy</a> package is required. This package is available from <a href="https://bioconductor.org/" class="external-link">Bioconductor</a>.</p>
<p>Processing microarray data is done in a very similar way as processing mass spectrometry data, as described in the previous section. The main difference is that the resulting object will in this case be an object object of class <code>ExpressionSet</code>, which is used as input in many Bioconductor packages.</p>
</div>
</div>
<div class="section level2">
<h2 id="writing-files-in-the-isa-tab-format-">Writing files in the ISA-Tab format.<a class="anchor" aria-label="anchor" href="#writing-files-in-the-isa-tab-format-"></a>
</h2>
<p>After updating an <code>ISA</code> object, it can be written back to a directory using the <code><a href="../reference/writeISAtab.html">writeISAtab()</a></code> function. All content of the <code>ISA</code> object will be written to investigation, study and assay files following the ISA-Tab standard for file specification. By default the files are written to the current working directory, but the directory can be specified using the <code>path</code> argument.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Write content of ISA object to a temporary directory.</span></span>
<span><span class="fu"><a href="../reference/writeISAtab.html">writeISAtab</a></span><span class="op">(</span>isaObject <span class="op">=</span> <span class="va">isaObject1</span>, </span>
<span>            path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Note that existing files are always overwritten. Therefore, writing files to the same directory, from where the original files were read, will result in the original files being overwritten.</p>
<p>Besides writing the full <code>ISA</code> object it is also possible to write only the investigation file , one or more study files or one or more assay files.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Write investigation file.</span></span>
<span><span class="fu"><a href="../reference/writeISAtab.html">writeInvestigationFile</a></span><span class="op">(</span>isaObject <span class="op">=</span> <span class="va">isaObject1</span>,</span>
<span>                       path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Write study file.</span></span>
<span><span class="fu"><a href="../reference/writeISAtab.html">writeStudyFiles</a></span><span class="op">(</span>isaObject <span class="op">=</span> <span class="va">isaObject1</span>,</span>
<span>                studyFilenames <span class="op">=</span> <span class="st">"s_study1.txt"</span>,</span>
<span>                path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Write assay file.</span></span>
<span><span class="fu"><a href="../reference/writeISAtab.html">writeAssayFiles</a></span><span class="op">(</span>isaObject <span class="op">=</span> <span class="va">isaObject1</span>,</span>
<span>                assayFilenames <span class="op">=</span> <span class="st">"a_study1.txt"</span>,</span>
<span>                path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<hr>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references">
<div id="ref-Atwell2010">
<p>Atwell, Susanna, Yu S. Huang, Bjarni J. Vilhjálmsson, Glenda Willems, Matthew Horton, Yan Li, Dazhe Meng, et al. 2010. “Genome-Wide Association Study of 107 Phenotypes in Arabidopsis Thaliana Inbred Lines.” <em>Nature</em> 465 (7298): 627–31. <a href="https://doi.org/10.1038/nature08800" class="external-link">https://doi.org/10.1038/nature08800</a>.</p>
</div>
<div id="ref-Saghatelian2004">
<p>Saghatelian, Alan, Sunia A. Trauger, Elizabeth J. Want, Edward G. Hawkins, Gary Siuzdak, and Benjamin F. Cravatt. 2004. “Assignment of Endogenous Substrates to Enzymes by Global Metabolite Profiling.” <em>Biochemistry</em> 43 (45): 14332–9. <a href="https://doi.org/10.1021/bi0480335" class="external-link">https://doi.org/10.1021/bi0480335</a>.</p>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Bart-Jan van Rossum, Maikel Verouden.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
